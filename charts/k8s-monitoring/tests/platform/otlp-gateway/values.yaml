---
cluster:
  name: otlp-gateway-test

destinations:
  - name: otlp-gateway
    type: otlp
    url: https://otlp-gateway-prod-us-east-0.grafana.net/otlp
    protocol: http
    auth:
      type: basic
      usernameKey: OTLP_GATEWAY_USER
      passwordKey: OTLP_GATEWAY_PASS
    secret:
      create: false
      name: grafana-cloud-credentials
    metrics: {enabled: true}
    logs: {enabled: true}
    traces: {enabled: true}
    processors:
      attributes:
        actions:
          - key: k8s.pod.name
            action: insert
            fromAttribute: pod
          - key: k8s.namespace.name
            action: insert
            fromAttribute: namespace
      k8sattributes:
        enabled: true
        metadata:
          - container.name
          - deployment.environment
          - k8s.cluster.name
          - k8s.container.name
          - k8s.replicaset.name
          - k8s.namespace.name
          - k8s.pod.name
          - k8s.deployment.name
          - service.name
          - service.namespace
          - k8s.statefulset.name
          - service.instance.id
          - k8s.daemonset.name
          - k8s.cronjob.name
          - k8s.job.name
          - k8s.node.name
          - k8s.pod.uid
          - k8s.pod.start_time

integrations:
  alloy:
    instances:
      - name: alloy
        labelSelectors:
          app.kubernetes.io/name: ["alloy-metrics"]

clusterMetrics:
  enabled: true

clusterEvents:
  enabled: true

podLogs:
  enabled: true
  labelsToKeep:
    - app.kubernetes.io/name
    - container
    - instance
    - job
    - level
    - namespace
    - service.name
    - service.namespace
    - deployment.environment
    - deployment.environment.name
    - k8s.namespace.name
    - k8s.deployment.name
    - k8s.statefulset.name
    - k8s.daemonset.name
    - k8s.cronjob.name
    - k8s.job.name
    - k8s.node.name
    - k8s.pod.name
    - pod
  structuredMetadata: {}

alloy-metrics:
  enabled: true
  liveDebugging:
    enabled: true

alloy-singleton:
  enabled: true

alloy-logs:
  enabled: true
