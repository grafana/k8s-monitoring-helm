# yamllint disable rule:document-start rule:line-length rule:trailing-spaces
suite: Test - Database Observability - MySQL
templates:
  - configmap.yaml
tests:
  - it: should render Alloy config for monitoring MySQL with exporter and query analysis enabled
    set:
      deployAsConfigMap: true
      mysql:
        instances:
          - name: my-dev-database
            dataSource:
              host: my-db.dev.svc
              auth:
                username: db-admin
                password: db-password
          - name: my-prod-database
            dataSource:
              rawString: root:root@tcp(my-db.prod.svc:3306)
    asserts:
      - isKind:
          of: ConfigMap
      - matchSnapshot:
          path: data["module.alloy"]
